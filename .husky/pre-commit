echo "ğŸ” Running pre-commit checks..."

# 1. Type checking first (fastest failure)
echo "ğŸ“‹ Type checking..."
if ! npm run type-check; then
  echo "âŒ Type check failed. Aborting commit."
  exit 1
fi

# 2. Linting and formatting
echo "ğŸ”§ Running lint-staged..."
if ! npx lint-staged; then
  echo "âŒ Linting/formatting failed. Aborting commit."
  exit 1
fi

# 3. Check for staged changes (from formatting)
if git diff --cached --quiet; then
  echo "âœ… No formatting changes needed."
else
  echo "âœ¨ Code was formatted. Adding changes to commit..."
  git add -u
fi

echo "ğŸš€ Pre-commit checks passed!"